# **RevPal**

A comprehensive "Agentic" interface for IDA Pro 9.0+. This toolset bridges the gap between IDA Pro and Large Language Models (LLMs), allowing for a bidirectional workflow: extracting deep analysis context for the AI, and applying the AI's reverse engineering findings back into the database.

## **Features**

* **XML-Based Context Dumps:** Generates structured XML datasets optimized for LLM parsing, containing code, memory layout, and types.  
* **System Prompt Embedding:** Automatically embeds a "Master CTF System Prompt" and challenge descriptions into the dump, creating a single ready-to-paste file.  
* **The Actuator:** A "Load" command that parses JSON output from the LLM to safely rename functions, define structures, and fix prototypes in your IDB.  
* **Safety First:** Automatic timestamped backups before the AI modifies your database.  
* **Smart Analysis:** Filters out compiler boilerplate and library functions to save token budget.

## **Requirements**

* **IDA Pro 9.0** or later (Required for idalib support).  
* **Python 3** installed on the host system.  
* **Root/Sudo access** (For installation only).

## **Installation**

1. Activate idalib:  
   Ensure the IDA Python library is linked. Run the activation script included with IDA:  
   \# Linux / macOS  
   sudo python3 /opt/ida-9.0/idalib/python/py-activate-idalib.py

2. Install the Suite:  
   Run the installer script:  
   chmod \+x install.sh  
   sudo ./install.sh

## **Usage**

The tool operates via two subcommands: dump (Extract) and load (Act).

### **1\. Dump (Extract Analysis)**

Analyzes a binary or existing database and produces an XML file for the LLM.  
revpal dump \<target\_file\> \[flags\]

**Flags:**

| Flag | Description |
| :---- | :---- |
| \-p, \--prompt | **Highly Recommended:** Embeds the "Master CTF System Prompt" into the XML. This instructs the LLM on how to analyze the file and format its response. |
| \-d "description" | Inserts specific context (e.g., "This is a heap exploitation challenge on port 1337"). |
| \--disasm | Includes raw disassembly alongside pseudocode. **Required** if you want the LLM to perform Actuator operations (renaming/fixing). |
| \--minimal | Reduces output size by skipping data segments and boilerplate functions. |

**Example:**  
revpal dump ./chall.exe \-p \--disasm \-d "Find the flag. The binary uses a custom crypto algorithm."

*Output: chall.exe\_dump.xml*

### **2\. Load (The Actuator)**

Takes a JSON file generated by the LLM and applies the changes to your IDA database.  
revpal load \<target\_file\> \<changes.json\>

**What it does:**

1. Creates a backup (.bak) of your database.  
2. Renames functions and global variables.  
3. Defines new C-style Structures in Local Types.  
4. Applies comments to assembly and pseudocode.  
5. Updates function prototypes (arguments/return types).

**Example:**  
revpal load ./chall.exe llm\_response.json

## **The Agentic Workflow**

This tool is designed for a specific loop:

1. Generate Context:  
   Run dump with the \-p flag.  
   revpal dump ./crackme \-p \--disasm

2. Feed the LLM:  
   Upload the resulting .xml file to your chatbot. The file contains instructions telling the AI to:  
   * Analyze the binary.  
   * Find vulnerabilities.  
   * **Generate an Actuator JSON block** at the end of its response.  
3. Extract & Apply:  
   Copy the JSON block from the LLM's response into a file (e.g., fix.json).  
   Run the load command to apply the reverse engineering work:  
   revpal load ./crackme fix.json

4. Open IDA:  
   Open the .i64 file. You will see renamed functions, commented code, and recovered structures waiting for you.

## **Actuator JSON Format**

If you wish to write manual changes or debug the LLM output, here is the schema:  
{  
  "actions": \[  
    {  
      "type": "rename",  
      "address": "0x401000",  
      "name": "check\_password"  
    },  
    {  
      "type": "create\_struct",  
      "name": "User",  
      "definition": "struct User { int id; char name\[32\]; };"  
    },  
    {  
      "type": "set\_type",  
      "address": "0x401000",  
      "definition": "int check\_password(User\* u);"  
    }  
  \]  
}  
